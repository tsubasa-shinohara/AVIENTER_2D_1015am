{"ast":null,"code":"// SVG描画関連の関数\nimport React from 'react';\nimport { SVG_CONFIG, ANALYSIS_VIEW_CONFIG } from './RocketConstants';\n\n// 安全な値を取得するユーティリティ関数 - より強化されたバージョン\nexport const getSafeValue = (value, defaultValue = 0) => {\n  // 値がnull、undefined、NaN、無限大の場合はデフォルト値を返す\n  if (value === null || value === undefined || isNaN(value) || !isFinite(value)) {\n    return defaultValue;\n  }\n  // 数値型でない場合、変換を試みる\n  if (typeof value !== 'number') {\n    const parsed = parseFloat(value);\n    // 変換できなければデフォルト値を返す\n    return isNaN(parsed) ? defaultValue : parsed;\n  }\n  return value;\n};\n\n// SVG描画関数 - 修正版\nexport const getNosePath = (configOrX, heightOrY, paramsOrNoseShape, noseHeight, bodyWidth, bodyHeight) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, noseShape, noseHeight, bodyWidth, bodyHeight)\n    const config = configOrX;\n    const noseShape = heightOrY;\n\n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getNosePath: Invalid config object', config);\n      // Default fallback config\n      config = {\n        centerX: 400,\n        height: 550\n      };\n    }\n\n    // Safe parameter handling\n    const safeNoseHeight = getSafeValue(noseHeight, 50);\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    const safeBodyHeight = getSafeValue(bodyHeight, 100);\n    const startX = config.centerX - safeBodyWidth / 2;\n    const endX = config.centerX + safeBodyWidth / 2;\n    const baseY = config.height - safeBodyHeight;\n    const topY = baseY - safeNoseHeight;\n    if (noseShape === \"cone\") {\n      // 円錐ノーズ\n      return `M ${startX} ${baseY} L ${config.centerX} ${topY} L ${endX} ${baseY} Z`;\n    } else if (noseShape === \"parabola\") {\n      // 放物線ノーズ\n      const controlY = topY + safeNoseHeight * 0.15;\n      return `M ${startX} ${baseY} \n              C ${startX} ${controlY}, ${config.centerX} ${topY}, ${config.centerX} ${topY}\n              C ${config.centerX} ${topY}, ${endX} ${controlY}, ${endX} ${baseY} Z`;\n    } else {\n      // オジブノーズ\n      const halfWidth = safeBodyWidth / 2;\n      return `M ${startX} ${baseY}\n              Q ${startX + halfWidth * 0.1} ${topY + safeNoseHeight * 0.4}, ${config.centerX} ${topY}\n              Q ${endX - halfWidth * 0.1} ${topY + safeNoseHeight * 0.4}, ${endX} ${baseY} Z`;\n    }\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrNoseShape;\n\n    // Safely get required values\n    const noseHeight = getSafeValue(params.noseHeight);\n    const bodyWidth = getSafeValue(params.bodyWidth);\n    const bodyHeight = getSafeValue(params.bodyHeight);\n    const startX = x - bodyWidth / 2;\n    const endX = x + bodyWidth / 2;\n    const baseY = y - bodyHeight;\n    const topY = baseY - noseHeight;\n    if (params && params.noseShape) {\n      // If noseShape is specified in params\n      if (params.noseShape === \"cone\") {\n        // 円錐ノーズ\n        return `M ${startX} ${baseY} L ${x} ${topY} L ${endX} ${baseY} Z`;\n      } else if (params.noseShape === \"parabola\") {\n        // 放物線ノーズ\n        const controlY = topY + noseHeight * 0.15;\n        return `M ${startX} ${baseY} \n                C ${startX} ${controlY}, ${x} ${topY}, ${x} ${topY}\n                C ${x} ${topY}, ${endX} ${controlY}, ${endX} ${baseY} Z`;\n      } else {\n        // オジブノーズ (Default)\n        const halfWidth = bodyWidth / 2;\n        return `M ${startX} ${baseY}\n                Q ${startX + halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${x} ${topY}\n                Q ${endX - halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${endX} ${baseY} Z`;\n      }\n    } else {\n      var _window$rocketSim;\n      // If no noseShape, get it from the global state (or assume ogive as default)\n      const noseShape = ((_window$rocketSim = window.rocketSim) === null || _window$rocketSim === void 0 ? void 0 : _window$rocketSim.noseShape) || \"ogive\";\n      if (noseShape === \"cone\") {\n        return `M ${startX} ${baseY} L ${x} ${topY} L ${endX} ${baseY} Z`;\n      } else if (noseShape === \"parabola\") {\n        const controlY = topY + noseHeight * 0.15;\n        return `M ${startX} ${baseY} \n                C ${startX} ${controlY}, ${x} ${topY}, ${x} ${topY}\n                C ${x} ${topY}, ${endX} ${controlY}, ${endX} ${baseY} Z`;\n      } else {\n        // Default to ogive\n        const halfWidth = bodyWidth / 2;\n        return `M ${startX} ${baseY}\n                Q ${startX + halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${x} ${topY}\n                Q ${endX - halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${endX} ${baseY} Z`;\n      }\n    }\n  }\n};\nexport const getBodyPath = (configOrX, heightOrY, paramsOrBodyHeight, bodyWidth) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, bodyHeight, bodyWidth)\n    const config = configOrX;\n    const bodyHeight = heightOrY;\n\n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getBodyPath: Invalid config object', config);\n      // Default fallback config\n      config = {\n        centerX: 400,\n        height: 550\n      };\n    }\n\n    // Safe parameter handling\n    const safeBodyHeight = getSafeValue(bodyHeight, 100);\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    const startX = config.centerX - safeBodyWidth / 2;\n    const endX = config.centerX + safeBodyWidth / 2;\n    const baseY = config.height;\n    const topY = baseY - safeBodyHeight;\n    return `M ${startX} ${baseY} \n            L ${startX} ${topY} \n            L ${endX} ${topY} \n            L ${endX} ${baseY} Z`;\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrBodyHeight;\n\n    // Safely get values\n    const safeX = getSafeValue(x, 0);\n    const safeY = getSafeValue(y, 0);\n    const bodyWidth = getSafeValue(params.bodyWidth, 0);\n    const bodyHeight = getSafeValue(params.bodyHeight, 0);\n    const startX = safeX - bodyWidth / 2;\n    const endX = safeX + bodyWidth / 2;\n    return `M ${startX} ${safeY} \n            L ${startX} ${safeY - bodyHeight} \n            L ${endX} ${safeY - bodyHeight} \n            L ${endX} ${safeY} Z`;\n  }\n};\nexport const getLeftFinPath = (configOrX, heightOrY, paramsOrBodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, bodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth)\n    const config = configOrX;\n    const bodyWidth = heightOrY;\n\n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getLeftFinPath: Invalid config object', config);\n      // Default fallback config\n      config = {\n        centerX: 400,\n        height: 550\n      };\n    }\n\n    // Safe parameter handling\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    const safeFinHeight = getSafeValue(finHeight, 40);\n    const safeFinBaseWidth = getSafeValue(finBaseWidth, 30);\n    const safeFinSweepLength = getSafeValue(finSweepLength, 0);\n    const safeFinTipWidth = getSafeValue(finTipWidth, 20);\n    const bodyLeftX = config.centerX - safeBodyWidth / 2;\n    const finBottomY = config.height;\n    const finTopY = finBottomY - safeFinBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + safeFinSweepLength;\n    const tipBottomY = tipTopY + safeFinTipWidth;\n    return `M ${bodyLeftX} ${finTopY}\n            L ${bodyLeftX} ${finBottomY}\n            L ${bodyLeftX - safeFinHeight} ${tipBottomY}\n            L ${bodyLeftX - safeFinHeight} ${tipTopY} Z`;\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrBodyWidth;\n\n    // Safely get values\n    const bodyWidth = getSafeValue(params.bodyWidth, 30);\n    const finHeight = getSafeValue(params.finHeight, 40);\n    const finBaseWidth = getSafeValue(params.finBaseWidth, 30);\n    const finSweepLength = getSafeValue(params.finSweepLength, 0);\n    const finTipWidth = getSafeValue(params.finTipWidth, 20);\n    const bodyLeftX = x - bodyWidth / 2;\n    const finBottomY = y;\n    const finTopY = finBottomY - finBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + finSweepLength;\n    const tipBottomY = tipTopY + finTipWidth;\n    return `M ${bodyLeftX} ${finTopY}\n            L ${bodyLeftX} ${finBottomY}\n            L ${bodyLeftX - finHeight} ${tipBottomY}\n            L ${bodyLeftX - finHeight} ${tipTopY} Z`;\n  }\n};\nexport const getRightFinPath = (configOrX, heightOrY, paramsOrBodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, bodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth)\n    const config = configOrX;\n    const bodyWidth = heightOrY;\n\n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getRightFinPath: Invalid config object', config);\n      // Default fallback config\n      config = {\n        centerX: 400,\n        height: 550\n      };\n    }\n\n    // Safe parameter handling\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    const safeFinHeight = getSafeValue(finHeight, 40);\n    const safeFinBaseWidth = getSafeValue(finBaseWidth, 30);\n    const safeFinSweepLength = getSafeValue(finSweepLength, 0);\n    const safeFinTipWidth = getSafeValue(finTipWidth, 20);\n    const bodyRightX = config.centerX + safeBodyWidth / 2;\n    const finBottomY = config.height;\n    const finTopY = finBottomY - safeFinBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + safeFinSweepLength;\n    const tipBottomY = tipTopY + safeFinTipWidth;\n    return `M ${bodyRightX} ${finTopY}\n            L ${bodyRightX} ${finBottomY}\n            L ${bodyRightX + safeFinHeight} ${tipBottomY}\n            L ${bodyRightX + safeFinHeight} ${tipTopY} Z`;\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrBodyWidth;\n\n    // Safely get values\n    const bodyWidth = getSafeValue(params.bodyWidth, 30);\n    const finHeight = getSafeValue(params.finHeight, 40);\n    const finBaseWidth = getSafeValue(params.finBaseWidth, 30);\n    const finSweepLength = getSafeValue(params.finSweepLength, 0);\n    const finTipWidth = getSafeValue(params.finTipWidth, 20);\n    const bodyRightX = x + bodyWidth / 2;\n    const finBottomY = y;\n    const finTopY = finBottomY - finBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + finSweepLength;\n    const tipBottomY = tipTopY + finTipWidth;\n    return `M ${bodyRightX} ${finTopY}\n            L ${bodyRightX} ${finBottomY}\n            L ${bodyRightX + finHeight} ${tipBottomY}\n            L ${bodyRightX + finHeight} ${tipTopY} Z`;\n  }\n};\nexport const getCenterFinsPath = (config, finThickness, finBaseWidth, finSweepLength, finTipWidth) => {\n  // configが有効かどうかを確認\n  if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n    console.warn('getCenterFinsPath: Invalid config object', config);\n    // デフォルト設定を作成\n    config = {\n      centerX: 400,\n      height: 550\n    };\n  }\n\n  // 安全なパラメータ処理\n  finThickness = getSafeValue(finThickness, 2);\n  finBaseWidth = getSafeValue(finBaseWidth, 30);\n  finSweepLength = getSafeValue(finSweepLength, 0);\n  finTipWidth = getSafeValue(finTipWidth, 20);\n  const halfThickness = finThickness / 2;\n  const finBottomY = config.height;\n  const finTopY = finBottomY - finBaseWidth;\n\n  // フィンの後端が左右のフィンと揃うように調整\n  const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n  return `M ${config.centerX - halfThickness} ${finTopY}\n          L ${config.centerX - halfThickness} ${finBottomY}\n          L ${config.centerX - halfThickness} ${finBottomY + finExtension}\n          L ${config.centerX + halfThickness} ${finBottomY + finExtension}\n          L ${config.centerX + halfThickness} ${finBottomY}\n          L ${config.centerX + halfThickness} ${finTopY} Z`;\n};\n\n// 姿勢表示用に中央のフィンを描画する関数\nexport const getCenterFinsPathForAttitude = (x, y, params) => {\n  // configが有効かどうかを確認\n  if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n    console.warn('getCenterFinsPathForAttitude: Invalid config object', config);\n    // デフォルト設定を作成\n    config = {\n      centerX: 400,\n      height: 550\n    };\n  }\n\n  // 安全なパラメータ処理\n  finThickness = getSafeValue(finThickness, 2);\n  finBaseWidth = getSafeValue(finBaseWidth, 30);\n  finSweepLength = getSafeValue(finSweepLength, 0);\n  finTipWidth = getSafeValue(finTipWidth, 20);\n  const halfThickness = params.finThickness / 2;\n  const finBottomY = y;\n  const finTopY = finBottomY - params.finBaseWidth;\n\n  // フィンの翼端位置を正確に計算\n  const tipTopY = finTopY + params.finSweepLength;\n  const tipBottomY = tipTopY + params.finTipWidth;\n\n  // フィンの後端が左右のフィンと揃うように調整\n  // フィンの翼端長がボディ後端よりも伸びる場合を計算\n  const finExtension = Math.max(0, params.finSweepLength + params.finTipWidth - params.finBaseWidth);\n  return `M ${x - halfThickness} ${finTopY}\n          L ${x - halfThickness} ${finBottomY}\n          L ${x - halfThickness} ${finBottomY + finExtension}\n          L ${x + halfThickness} ${finBottomY + finExtension}\n          L ${x + halfThickness} ${finBottomY}\n          L ${x + halfThickness} ${finTopY} Z`;\n};\n\n// シミュレーションタブ用のロケット描画関数を追加\nexport const drawInitialRocket = (centerX, centerY, params, rotation) => {\n  // 回転を考慮した変換\n  const transform = `translate(${centerX}, ${centerY}) rotate(${rotation})`;\n\n  // 各部品のパス計算\n  const bodyPath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                     L ${-params.bodyWidth / 2} ${0} \n                     L ${params.bodyWidth / 2} ${0} \n                     L ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n  let nosePath;\n  if (params.noseShape === \"cone\") {\n    nosePath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                  L ${0} ${-params.bodyHeight - params.noseHeight} \n                  L ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n  } else if (params.noseShape === \"parabola\") {\n    nosePath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                  Q ${0} ${-params.bodyHeight - params.noseHeight * 1.2}, \n                    ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n  } else {\n    // ogive\n    nosePath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                  Q ${0} ${-params.bodyHeight - params.noseHeight * 1.1}, \n                    ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n  }\n  const leftFinPath = `M ${-params.bodyWidth / 2} ${-params.finBaseWidth} \n                         L ${-params.bodyWidth / 2} ${0} \n                         L ${-params.bodyWidth / 2 - params.finHeight} ${params.finSweepLength} \n                         L ${-params.bodyWidth / 2 - params.finHeight} ${params.finSweepLength - params.finTipWidth} Z`;\n  const rightFinPath = `M ${params.bodyWidth / 2} ${-params.finBaseWidth} \n                          L ${params.bodyWidth / 2} ${0} \n                          L ${params.bodyWidth / 2 + params.finHeight} ${params.finSweepLength} \n                          L ${params.bodyWidth / 2 + params.finHeight} ${params.finSweepLength - params.finTipWidth} Z`;\n  return {\n    transform,\n    bodyPath,\n    nosePath,\n    leftFinPath,\n    rightFinPath,\n    centerFinsPath: `M ${-params.finThickness / 2} ${-params.finBaseWidth} \n                      L ${-params.finThickness / 2} ${0} \n                      L ${params.finThickness / 2} ${0} \n                      L ${params.finThickness / 2} ${-params.finBaseWidth} Z`\n  };\n};\n\n// フィンを取得する総合的な関数\nexport const getFinPaths = (x, y, params, deflection = 0) => {\n  const bodyLeftX = x - params.bodyWidth / 2;\n  const bodyRightX = x + params.bodyWidth / 2;\n  const finBottomY = y;\n  const finTopY = finBottomY - params.finBaseWidth;\n\n  // たわみを考慮した修正\n  const deflectionAngle = deflection * Math.PI / 180; // ラジアンに変換\n\n  // 翼端長がボディ後端より後ろに出るように調整\n  const tipTopY = finTopY + params.finSweepLength;\n  const tipBottomY = tipTopY + params.finTipWidth;\n\n  // たわみを適用したフィン座標\n  const leftFinTipX = bodyLeftX - params.finHeight * Math.cos(deflectionAngle);\n  const leftFinTipY = tipTopY + params.finHeight * Math.sin(deflectionAngle);\n  const leftFinBottomTipX = bodyLeftX - params.finHeight * Math.cos(deflectionAngle);\n  const leftFinBottomTipY = tipBottomY + params.finHeight * Math.sin(deflectionAngle);\n  const rightFinTipX = bodyRightX + params.finHeight * Math.cos(deflectionAngle);\n  const rightFinTipY = tipTopY + params.finHeight * Math.sin(deflectionAngle);\n  const rightFinBottomTipX = bodyRightX + params.finHeight * Math.cos(deflectionAngle);\n  const rightFinBottomTipY = tipBottomY + params.finHeight * Math.sin(deflectionAngle);\n  const leftFin = `M ${bodyLeftX} ${finTopY}\n                  L ${bodyLeftX} ${finBottomY}\n                  L ${leftFinBottomTipX} ${leftFinBottomTipY}\n                  L ${leftFinTipX} ${leftFinTipY} Z`;\n  const rightFin = `M ${bodyRightX} ${finTopY}\n                  L ${bodyRightX} ${finBottomY}\n                  L ${rightFinBottomTipX} ${rightFinBottomTipY}\n                  L ${rightFinTipX} ${rightFinTipY} Z`;\n  const halfThickness = params.finThickness / 2;\n  const centerFins = `M ${x - halfThickness} ${finTopY}\n                    L ${x - halfThickness} ${finBottomY}\n                    L ${x + halfThickness} ${finBottomY}\n                    L ${x + halfThickness} ${finTopY} Z`;\n  return {\n    leftFin,\n    rightFin,\n    centerFins\n  };\n};\n\n// 風向き矢印の描画関数\nexport const getWindArrow = windSpeed => {\n  if (windSpeed === 0) return null;\n\n  // 風速に基づいた矢印の長さ\n  const arrowLength = Math.min(100, Math.max(40, Math.abs(windSpeed) * 10));\n\n  // 「風速: X m/s」テキストの中央位置\n  const textCenter = 85; // テキスト中央のx座標\n  const y = 50; // テキスト下のy座標\n\n  // 矢印の色と太さを取得\n  const color = getWindArrowColor(windSpeed);\n  const strokeWidth = getWindArrowWidth(windSpeed);\n\n  // 矢印の頭の大きさ\n  const headSize = 15;\n\n  // 風速の符号で場合分け\n  if (windSpeed < 0) {\n    // マイナスの場合 - 右向き矢印\n    const startX = textCenter - arrowLength / 2;\n    const endX = textCenter + arrowLength / 2;\n    return {\n      line: `M ${startX} ${y} L ${endX} ${y}`,\n      head: `M ${endX - headSize} ${y - headSize / 2} L ${endX} ${y} L ${endX - headSize} ${y + headSize / 2}`,\n      y: y,\n      color: color,\n      strokeWidth: strokeWidth\n    };\n  } else {\n    // プラスの場合 - 左向き矢印だが、矢じりは右端\n    const lineStart = textCenter - arrowLength / 2;\n    const lineEnd = textCenter + arrowLength / 2;\n    return {\n      line: `M ${lineStart} ${y} L ${lineEnd} ${y}`,\n      head: `M ${lineStart + headSize} ${y - headSize / 2} L ${lineStart} ${y} L ${lineStart + headSize} ${y + headSize / 2}`,\n      y: y,\n      color: color,\n      strokeWidth: strokeWidth\n    };\n  }\n};\n\n// 風速に応じた矢印の色を取得する関数\nexport const getWindArrowColor = speed => {\n  const absSpeed = Math.abs(speed);\n  if (absSpeed >= 6) return \"#e74c3c\"; // 強風: 赤色\n  if (absSpeed >= 3) return \"#f39c12\"; // 中風: オレンジ/黄色\n  return \"#2ecc71\"; // 弱風: 緑色\n};\n\n// 風速に応じた矢印の線の太さを取得する関数\nexport const getWindArrowWidth = speed => {\n  const absSpeed = Math.abs(speed);\n  if (absSpeed >= 6) return 5; // 強風: より太い線\n  if (absSpeed >= 3) return 4; // 中風: やや太い線\n  return 3; // 弱風: 通常の線\n};\n\n// パラシュート表示を改良\nexport const getParachutePath = (x, y, isOpen, deploymentProgress = 1.0, rotation = 0, rocketLength, selectedParachute, trajectoryScale) => {\n  if (!isOpen) return \"\";\n\n  // ロケットの長さを基準に計算\n  // 基準距離を短くして調整（1.5倍にする）\n  const baseOffsetDistance = rocketLength * 1.5;\n  const offsetDistance = baseOffsetDistance * trajectoryScale * deploymentProgress;\n\n  // 機体の上部に常に配置するため、回転角度を無視\n  // xは変更せず、yだけ上方向に移動\n  const parachuteX = x;\n  const parachuteY = y - offsetDistance;\n\n  // パラシュートサイズの計算\n  const parachuteSize = parseInt(selectedParachute.slice(1)) / 1000 / 2 * trajectoryScale * deploymentProgress;\n\n  // パラシュートのパスを描画\n  return `M ${parachuteX - parachuteSize} ${parachuteY}\n          C ${parachuteX - parachuteSize} ${parachuteY - parachuteSize * 0.8},\n            ${parachuteX} ${parachuteY - parachuteSize * 1.2},\n            ${parachuteX + parachuteSize} ${parachuteY - parachuteSize * 0.8}\n          C ${parachuteX + parachuteSize} ${parachuteY - parachuteSize * 0.8},\n            ${parachuteX + parachuteSize} ${parachuteY},\n            ${parachuteX + parachuteSize} ${parachuteY}\n          Z`;\n};\n\n// パラシュートの紐を描画\nexport const getParachuteStringPaths = (x, y, isOpen, deploymentProgress = 1.0, rotation = 0, rocketLength, selectedParachute, trajectoryScale) => {\n  if (!isOpen) return '';\n\n  // パラシュート本体と全く同じ計算を使用して一貫性を確保\n  const baseOffsetDistance = rocketLength * 1.5;\n  const offsetDistance = baseOffsetDistance * trajectoryScale * deploymentProgress;\n\n  // 機体の上部に常に配置\n  const parachuteX = x;\n  const parachuteY = y - offsetDistance;\n\n  // パラシュートサイズも同一の計算で\n  const parachuteSize = parseInt(selectedParachute.slice(1)) / 1000 / 2 * trajectoryScale * deploymentProgress;\n\n  // キャノピーの各部分の座標を計算\n  const canopyLeftX = parachuteX - parachuteSize;\n  const canopyRightX = parachuteX + parachuteSize;\n  const canopyBottomY = parachuteY;\n  const canopyCenterX = parachuteX;\n  const canopyCenterTopY = parachuteY - parachuteSize * 0.5;\n\n  // 紐のパスを描画 - ロケット位置からキャノピーの各点まで\n  return `M ${x} ${y} L ${canopyLeftX} ${canopyBottomY}\n          M ${x} ${y} L ${canopyCenterX} ${canopyCenterTopY}\n          M ${x} ${y} L ${canopyRightX} ${canopyBottomY}`;\n};\n\n// メートル単位からSVG座標への変換関数\nexport const metersToSvgX = (meters, trajectoryScale) => {\n  // NaNチェック追加\n  if (isNaN(meters)) {\n    console.warn('metersToSvgX: 無効なメートル値', meters);\n    return SVG_CONFIG.centerX;\n  }\n\n  // trajectoryScaleが数値でない場合のフォールバック\n  if (typeof trajectoryScale !== 'number' || isNaN(trajectoryScale) || trajectoryScale <= 0) {\n    console.warn('metersToSvgX: 無効なtrajectoryScale', trajectoryScale);\n    trajectoryScale = 10.0; // より安全なデフォルト値\n  }\n  return SVG_CONFIG.centerX + meters * trajectoryScale;\n};\nexport const metersToSvgY = (meters, trajectoryScale) => {\n  // NaNチェック\n  if (isNaN(meters)) {\n    console.warn('metersToSvgY: 無効なメートル値', meters);\n    return SVG_CONFIG.groundLevel;\n  }\n\n  // trajectoryScaleが数値でない場合のフォールバック\n  if (typeof trajectoryScale !== 'number' || isNaN(trajectoryScale) || trajectoryScale <= 0) {\n    console.warn('metersToSvgY: 無効なtrajectoryScale', trajectoryScale);\n    trajectoryScale = 10.0; // より安全なデフォルト値\n  }\n  return SVG_CONFIG.groundLevel - meters * trajectoryScale;\n};\n\n// 安全な回転属性を生成する関数\nexport const getSafeRotationTransform = (rotation, x, y) => {\n  // 全ての値にNaNチェック\n  const safeRotation = isNaN(rotation) ? 0 : rotation;\n  const safeX = isNaN(x) ? SVG_CONFIG.centerX : x;\n  const safeY = isNaN(y) ? SVG_CONFIG.groundLevel : y;\n  return `rotate(${safeRotation} ${safeX} ${safeY})`;\n};\n\n// 姿勢表示用のロケットスケールを自動計算する関数を追加\nexport const calculateAttitudeDisplayScale = (rocketParams, circleRadius = 90) => {\n  try {\n    // 必要なパラメータを安全に取得\n    const noseHeight = getSafeValue(rocketParams.noseHeight, 50);\n    const bodyHeight = getSafeValue(rocketParams.bodyHeight, 200);\n    const finSweepLength = getSafeValue(rocketParams.finSweepLength, 0);\n    const finTipWidth = getSafeValue(rocketParams.finTipWidth, 20);\n    const finBaseWidth = getSafeValue(rocketParams.finBaseWidth, 30);\n\n    // ロケットの寸法を計算\n    const actualRocketHeight = noseHeight + bodyHeight;\n    const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n    const totalHeight = actualRocketHeight + finExtension;\n\n    // スケール計算 - 安全範囲内に制限\n    const rawScale = circleRadius * 1.6 / Math.max(50, totalHeight);\n    return Math.max(0.01, Math.min(2.0, rawScale));\n  } catch (error) {\n    console.error('calculateAttitudeDisplayScale エラー:', error);\n    return 0.3; // エラー時のデフォルト値\n  }\n};\n\n// 視覚化のための風速高度分布矢印を描画する関数\nexport const getWindProfileArrows = (baseWindSpeed, profile, showWindArrows, metersToSvgY, calculateWindSpeedAtHeight) => {\n  if (!showWindArrows) return [];\n\n  // 表示する高度レベル（メートル）\n  const heights = [0, 20, 40, 60, 80];\n  return heights.map(height => {\n    // 各高度での風速を計算\n    const windSpeed = calculateWindSpeedAtHeight(baseWindSpeed, height, profile);\n\n    // SVG座標に変換\n    const y = metersToSvgY(height);\n\n    // 風速によって矢印の長さを制限して表示範囲内に収める\n    // 最大長さをより小さく設定し、範囲内に確実に収める\n    const maxArrowLength = 60; // 最大長さを短くして確実に範囲内に収める\n    const minArrowLength = 20; // 最小長さ\n    const arrowLength = Math.min(maxArrowLength, Math.max(minArrowLength, Math.abs(windSpeed) * 6));\n    const color = getWindArrowColor(windSpeed);\n    const strokeWidth = getWindArrowWidth(windSpeed);\n\n    // 表示位置の調整 - 右に寄せて表示するように修正\n    const startX = 80; // 右寄りに配置\n    // 矢印の向きを修正 - 既存の風向き矢印と同じロジック\n    const direction = windSpeed < 0 ? 1 : -1; // 負の風速で右向き、正の風速で左向き\n\n    // 矢印の端点の位置を計算\n    const endX = startX + arrowLength * direction;\n\n    // テキスト位置の調整\n    // 矢印の長さと方向に応じてテキスト位置を調整し、矢印から適切な距離に配置\n    const textOffsetX = direction > 0 ? 12 : -35; // テキストのオフセット\n\n    return {\n      height,\n      windSpeed,\n      y,\n      arrowPath: {\n        // 矢印の線\n        line: `M ${startX} ${y} L ${endX} ${y}`,\n        // 矢印の頭\n        head: direction > 0 ? `M ${endX - 10} ${y - 5} L ${endX} ${y} L ${endX - 10} ${y + 5}` : `M ${endX + 10} ${y - 5} L ${endX} ${y} L ${endX + 10} ${y + 5}`,\n        // 風速テキスト - 常に表示範囲内に収まるように位置調整\n        textX: endX + textOffsetX,\n        textY: y,\n        color,\n        strokeWidth\n      }\n    };\n  });\n};\n\n// ロケット寸法計算関数\nexport const getActualRocketDimensions = (config, noseHeight, bodyHeight, finSweepLength, finTipWidth, finBaseWidth) => {\n  const rocketTopY = config.height - bodyHeight - noseHeight;\n  // 機体全長の計算 - ノーズとボディの高さ\n  const actualRocketHeight = noseHeight + bodyHeight;\n  // フィンの後端がボディ後端よりも出る場合の計算\n  const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n  // 全長は機体長 + フィン後端部分\n  const totalHeight = actualRocketHeight + finExtension;\n  return {\n    rocketTopY,\n    actualRocketHeight,\n    totalHeight\n  };\n};\n\n// 設計タブ用のviewBox計算関数\nexport const getDesignViewBox = (design, noseHeight, bodyHeight, finHeight, finSweepLength, finTipWidth, finBaseWidth, bodyWidth) => {\n  // 直接ロケット寸法を計算\n  const rocketTopY = design.height - bodyHeight - noseHeight;\n  const actualRocketHeight = noseHeight + bodyHeight;\n  const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n  const totalHeight = actualRocketHeight + finExtension;\n\n  // フィンの左右の最大幅を計算\n  const maxFinWidth = finHeight;\n\n  // 左右のマージンを追加 - より広いマージンを確保\n  const horizontalMargin = Math.max(maxFinWidth + 20, design.width * 0.25);\n\n  // 垂直方向のマージンを追加 - 新規追加\n  const verticalMargin = Math.max(totalHeight * 0.2, 50);\n\n  // 全幅 (ボディ幅 + 左右のフィン)\n  const totalWidth = bodyWidth + maxFinWidth * 2;\n\n  // 余裕を持たせた表示エリアのサイズ - 余裕を増やす\n  const paddedHeight = totalHeight * 1.4; // 40%の余裕に増加\n  const paddedWidth = totalWidth * 1.4; // 40%の余裕に増加\n\n  // 表示エリアのアスペクト比\n  const viewBoxAspectRatio = design.width / design.height;\n\n  // ロケットのアスペクト比と比較して表示方法を決定\n  let viewBoxWidth, viewBoxHeight;\n  if (paddedWidth / paddedHeight > viewBoxAspectRatio) {\n    // 幅が制限要素の場合\n    viewBoxWidth = paddedWidth;\n    viewBoxHeight = paddedWidth / viewBoxAspectRatio;\n  } else {\n    // 高さが制限要素の場合\n    viewBoxHeight = paddedHeight;\n    viewBoxWidth = paddedHeight * viewBoxAspectRatio;\n  }\n\n  // 表示領域を計算 - 上部に余裕を持たせるように変更\n  return `-${horizontalMargin} -${verticalMargin} ${design.width + horizontalMargin * 2} ${design.height + verticalMargin * 2}`;\n};\n\n// 重量・空力特性タブ用のviewBox計算関数（改善版）\nexport const getAnalysisViewBox = () => {\n  // ロケットが確実に中央に表示されるようなviewBox\n  return \"-200 -400 400 800\";\n};\n\n// ロケットの拡大率を計算する関数\nexport const calculateRocketScale = (totalHeight, canvasHeight) => {\n  // 画面の70%を使うように計算\n  const targetHeight = canvasHeight * 0.7;\n\n  // スケール係数の計算\n  const scale = targetHeight / totalHeight;\n\n  // 最小・最大スケール値の制限\n  return Math.max(0.5, Math.min(2.0, scale));\n};\n\n// ロケットのSVG位置変換を計算する関数\nexport const getRocketTransform = (totalHeight, canvasWidth, canvasHeight) => {\n  // 動的なスケール計算\n  const scale = calculateRocketScale(totalHeight, canvasHeight);\n\n  // 移動量の計算（キャンバスの中央に配置）\n  const translateX = canvasWidth / 2;\n  const translateY = canvasHeight / 2 - totalHeight * scale / 2;\n  return {\n    translateX,\n    translateY,\n    scale,\n    transform: `translate(${translateX}, ${translateY}) scale(${scale})`\n  };\n};","map":{"version":3,"names":["React","SVG_CONFIG","ANALYSIS_VIEW_CONFIG","getSafeValue","value","defaultValue","undefined","isNaN","isFinite","parsed","parseFloat","getNosePath","configOrX","heightOrY","paramsOrNoseShape","noseHeight","bodyWidth","bodyHeight","config","noseShape","console","warn","centerX","height","safeNoseHeight","safeBodyWidth","safeBodyHeight","startX","endX","baseY","topY","controlY","halfWidth","x","y","params","_window$rocketSim","window","rocketSim","getBodyPath","paramsOrBodyHeight","safeX","safeY","getLeftFinPath","paramsOrBodyWidth","finHeight","finBaseWidth","finSweepLength","finTipWidth","safeFinHeight","safeFinBaseWidth","safeFinSweepLength","safeFinTipWidth","bodyLeftX","finBottomY","finTopY","tipTopY","tipBottomY","getRightFinPath","bodyRightX","getCenterFinsPath","finThickness","halfThickness","finExtension","Math","max","getCenterFinsPathForAttitude","drawInitialRocket","centerY","rotation","transform","bodyPath","nosePath","leftFinPath","rightFinPath","centerFinsPath","getFinPaths","deflection","deflectionAngle","PI","leftFinTipX","cos","leftFinTipY","sin","leftFinBottomTipX","leftFinBottomTipY","rightFinTipX","rightFinTipY","rightFinBottomTipX","rightFinBottomTipY","leftFin","rightFin","centerFins","getWindArrow","windSpeed","arrowLength","min","abs","textCenter","color","getWindArrowColor","strokeWidth","getWindArrowWidth","headSize","line","head","lineStart","lineEnd","speed","absSpeed","getParachutePath","isOpen","deploymentProgress","rocketLength","selectedParachute","trajectoryScale","baseOffsetDistance","offsetDistance","parachuteX","parachuteY","parachuteSize","parseInt","slice","getParachuteStringPaths","canopyLeftX","canopyRightX","canopyBottomY","canopyCenterX","canopyCenterTopY","metersToSvgX","meters","metersToSvgY","groundLevel","getSafeRotationTransform","safeRotation","calculateAttitudeDisplayScale","rocketParams","circleRadius","actualRocketHeight","totalHeight","rawScale","error","getWindProfileArrows","baseWindSpeed","profile","showWindArrows","calculateWindSpeedAtHeight","heights","map","maxArrowLength","minArrowLength","direction","textOffsetX","arrowPath","textX","textY","getActualRocketDimensions","rocketTopY","getDesignViewBox","design","maxFinWidth","horizontalMargin","width","verticalMargin","totalWidth","paddedHeight","paddedWidth","viewBoxAspectRatio","viewBoxWidth","viewBoxHeight","getAnalysisViewBox","calculateRocketScale","canvasHeight","targetHeight","scale","getRocketTransform","canvasWidth","translateX","translateY"],"sources":["/Users/shinoharatsubasa/Documents/RocketSim_New_2d_integ/src/components/rocket/RocketRendering.jsx"],"sourcesContent":["// SVG描画関連の関数\nimport React from 'react';\nimport { SVG_CONFIG, ANALYSIS_VIEW_CONFIG } from './RocketConstants';\n\n// 安全な値を取得するユーティリティ関数 - より強化されたバージョン\nexport const getSafeValue = (value, defaultValue = 0) => {\n  // 値がnull、undefined、NaN、無限大の場合はデフォルト値を返す\n  if (value === null || value === undefined || isNaN(value) || !isFinite(value)) {\n    return defaultValue;\n  }\n  // 数値型でない場合、変換を試みる\n  if (typeof value !== 'number') {\n    const parsed = parseFloat(value);\n    // 変換できなければデフォルト値を返す\n    return isNaN(parsed) ? defaultValue : parsed;\n  }\n  return value;\n};\n\n// SVG描画関数 - 修正版\nexport const getNosePath = (configOrX, heightOrY, paramsOrNoseShape, noseHeight, bodyWidth, bodyHeight) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, noseShape, noseHeight, bodyWidth, bodyHeight)\n    const config = configOrX;\n    const noseShape = heightOrY;\n    \n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getNosePath: Invalid config object', config);\n      // Default fallback config\n      config = { centerX: 400, height: 550 };\n    }\n    \n    // Safe parameter handling\n    const safeNoseHeight = getSafeValue(noseHeight, 50);\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    const safeBodyHeight = getSafeValue(bodyHeight, 100);\n    \n    const startX = config.centerX - safeBodyWidth / 2;\n    const endX = config.centerX + safeBodyWidth / 2;\n    const baseY = config.height - safeBodyHeight;\n    const topY = baseY - safeNoseHeight;\n    \n    if (noseShape === \"cone\") {\n      // 円錐ノーズ\n      return `M ${startX} ${baseY} L ${config.centerX} ${topY} L ${endX} ${baseY} Z`;\n    } else if (noseShape === \"parabola\") {\n      // 放物線ノーズ\n      const controlY = topY + safeNoseHeight * 0.15;\n      return `M ${startX} ${baseY} \n              C ${startX} ${controlY}, ${config.centerX} ${topY}, ${config.centerX} ${topY}\n              C ${config.centerX} ${topY}, ${endX} ${controlY}, ${endX} ${baseY} Z`;\n    } else {\n      // オジブノーズ\n      const halfWidth = safeBodyWidth / 2;\n      return `M ${startX} ${baseY}\n              Q ${startX + halfWidth * 0.1} ${topY + safeNoseHeight * 0.4}, ${config.centerX} ${topY}\n              Q ${endX - halfWidth * 0.1} ${topY + safeNoseHeight * 0.4}, ${endX} ${baseY} Z`;\n    }\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrNoseShape;\n    \n    // Safely get required values\n    const noseHeight = getSafeValue(params.noseHeight);\n    const bodyWidth = getSafeValue(params.bodyWidth);\n    const bodyHeight = getSafeValue(params.bodyHeight);\n    \n    const startX = x - bodyWidth / 2;\n    const endX = x + bodyWidth / 2;\n    const baseY = y - bodyHeight;\n    const topY = baseY - noseHeight;\n    \n    if (params && params.noseShape) {\n      // If noseShape is specified in params\n      if (params.noseShape === \"cone\") {\n        // 円錐ノーズ\n        return `M ${startX} ${baseY} L ${x} ${topY} L ${endX} ${baseY} Z`;\n      } else if (params.noseShape === \"parabola\") {\n        // 放物線ノーズ\n        const controlY = topY + noseHeight * 0.15;\n        return `M ${startX} ${baseY} \n                C ${startX} ${controlY}, ${x} ${topY}, ${x} ${topY}\n                C ${x} ${topY}, ${endX} ${controlY}, ${endX} ${baseY} Z`;\n      } else {\n        // オジブノーズ (Default)\n        const halfWidth = bodyWidth / 2;\n        return `M ${startX} ${baseY}\n                Q ${startX + halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${x} ${topY}\n                Q ${endX - halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${endX} ${baseY} Z`;\n      }\n    } else {\n      // If no noseShape, get it from the global state (or assume ogive as default)\n      const noseShape = window.rocketSim?.noseShape || \"ogive\";\n      \n      if (noseShape === \"cone\") {\n        return `M ${startX} ${baseY} L ${x} ${topY} L ${endX} ${baseY} Z`;\n      } else if (noseShape === \"parabola\") {\n        const controlY = topY + noseHeight * 0.15;\n        return `M ${startX} ${baseY} \n                C ${startX} ${controlY}, ${x} ${topY}, ${x} ${topY}\n                C ${x} ${topY}, ${endX} ${controlY}, ${endX} ${baseY} Z`;\n      } else {\n        // Default to ogive\n        const halfWidth = bodyWidth / 2;\n        return `M ${startX} ${baseY}\n                Q ${startX + halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${x} ${topY}\n                Q ${endX - halfWidth * 0.1} ${topY + noseHeight * 0.4}, ${endX} ${baseY} Z`;\n      }\n    }\n  }\n};\n\nexport const getBodyPath = (configOrX, heightOrY, paramsOrBodyHeight, bodyWidth) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, bodyHeight, bodyWidth)\n    const config = configOrX;\n    const bodyHeight = heightOrY;\n    \n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getBodyPath: Invalid config object', config);\n      // Default fallback config\n      config = { centerX: 400, height: 550 };\n    }\n\n    // Safe parameter handling\n    const safeBodyHeight = getSafeValue(bodyHeight, 100);\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    \n    const startX = config.centerX - safeBodyWidth / 2;\n    const endX = config.centerX + safeBodyWidth / 2;\n    const baseY = config.height;\n    const topY = baseY - safeBodyHeight;\n\n    return `M ${startX} ${baseY} \n            L ${startX} ${topY} \n            L ${endX} ${topY} \n            L ${endX} ${baseY} Z`;\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrBodyHeight;\n    \n    // Safely get values\n    const safeX = getSafeValue(x, 0);\n    const safeY = getSafeValue(y, 0);\n    const bodyWidth = getSafeValue(params.bodyWidth, 0);\n    const bodyHeight = getSafeValue(params.bodyHeight, 0);\n    \n    const startX = safeX - bodyWidth / 2;\n    const endX = safeX + bodyWidth / 2;\n    \n    return `M ${startX} ${safeY} \n            L ${startX} ${safeY - bodyHeight} \n            L ${endX} ${safeY - bodyHeight} \n            L ${endX} ${safeY} Z`;\n  }\n};\n\nexport const getLeftFinPath = (configOrX, heightOrY, paramsOrBodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, bodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth)\n    const config = configOrX;\n    const bodyWidth = heightOrY;\n    \n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getLeftFinPath: Invalid config object', config);\n      // Default fallback config\n      config = { centerX: 400, height: 550 };\n    }\n\n    // Safe parameter handling\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    const safeFinHeight = getSafeValue(finHeight, 40);\n    const safeFinBaseWidth = getSafeValue(finBaseWidth, 30);\n    const safeFinSweepLength = getSafeValue(finSweepLength, 0);\n    const safeFinTipWidth = getSafeValue(finTipWidth, 20);\n    \n    const bodyLeftX = config.centerX - safeBodyWidth / 2;\n    const finBottomY = config.height;\n    const finTopY = finBottomY - safeFinBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + safeFinSweepLength;\n    const tipBottomY = tipTopY + safeFinTipWidth;\n\n    return `M ${bodyLeftX} ${finTopY}\n            L ${bodyLeftX} ${finBottomY}\n            L ${bodyLeftX - safeFinHeight} ${tipBottomY}\n            L ${bodyLeftX - safeFinHeight} ${tipTopY} Z`;\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrBodyWidth;\n    \n    // Safely get values\n    const bodyWidth = getSafeValue(params.bodyWidth, 30);\n    const finHeight = getSafeValue(params.finHeight, 40);\n    const finBaseWidth = getSafeValue(params.finBaseWidth, 30);\n    const finSweepLength = getSafeValue(params.finSweepLength, 0);\n    const finTipWidth = getSafeValue(params.finTipWidth, 20);\n    \n    const bodyLeftX = x - bodyWidth / 2;\n    const finBottomY = y;\n    const finTopY = finBottomY - finBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + finSweepLength;\n    const tipBottomY = tipTopY + finTipWidth;\n\n    return `M ${bodyLeftX} ${finTopY}\n            L ${bodyLeftX} ${finBottomY}\n            L ${bodyLeftX - finHeight} ${tipBottomY}\n            L ${bodyLeftX - finHeight} ${tipTopY} Z`;\n  }\n};\n\nexport const getRightFinPath = (configOrX, heightOrY, paramsOrBodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth) => {\n  // Check which parameter style is being used\n  if (typeof configOrX === 'object' && configOrX !== null) {\n    // Original style: (config, bodyWidth, finHeight, finBaseWidth, finSweepLength, finTipWidth)\n    const config = configOrX;\n    const bodyWidth = heightOrY;\n    \n    // Ensure config has required properties\n    if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n      console.warn('getRightFinPath: Invalid config object', config);\n      // Default fallback config\n      config = { centerX: 400, height: 550 };\n    }\n\n    // Safe parameter handling\n    const safeBodyWidth = getSafeValue(bodyWidth, 30);\n    const safeFinHeight = getSafeValue(finHeight, 40);\n    const safeFinBaseWidth = getSafeValue(finBaseWidth, 30);\n    const safeFinSweepLength = getSafeValue(finSweepLength, 0);\n    const safeFinTipWidth = getSafeValue(finTipWidth, 20);\n    \n    const bodyRightX = config.centerX + safeBodyWidth / 2;\n    const finBottomY = config.height;\n    const finTopY = finBottomY - safeFinBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + safeFinSweepLength;\n    const tipBottomY = tipTopY + safeFinTipWidth;\n\n    return `M ${bodyRightX} ${finTopY}\n            L ${bodyRightX} ${finBottomY}\n            L ${bodyRightX + safeFinHeight} ${tipBottomY}\n            L ${bodyRightX + safeFinHeight} ${tipTopY} Z`;\n  } else {\n    // New style: (x, y, params)\n    const x = configOrX;\n    const y = heightOrY;\n    const params = paramsOrBodyWidth;\n    \n    // Safely get values\n    const bodyWidth = getSafeValue(params.bodyWidth, 30);\n    const finHeight = getSafeValue(params.finHeight, 40);\n    const finBaseWidth = getSafeValue(params.finBaseWidth, 30);\n    const finSweepLength = getSafeValue(params.finSweepLength, 0);\n    const finTipWidth = getSafeValue(params.finTipWidth, 20);\n    \n    const bodyRightX = x + bodyWidth / 2;\n    const finBottomY = y;\n    const finTopY = finBottomY - finBaseWidth;\n\n    // フィンの翼端位置を正確に計算\n    const tipTopY = finTopY + finSweepLength;\n    const tipBottomY = tipTopY + finTipWidth;\n\n    return `M ${bodyRightX} ${finTopY}\n            L ${bodyRightX} ${finBottomY}\n            L ${bodyRightX + finHeight} ${tipBottomY}\n            L ${bodyRightX + finHeight} ${tipTopY} Z`;\n  }\n};\n\nexport const getCenterFinsPath = (config, finThickness, finBaseWidth, finSweepLength, finTipWidth) => {\n  // configが有効かどうかを確認\n  if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n    console.warn('getCenterFinsPath: Invalid config object', config);\n    // デフォルト設定を作成\n    config = { centerX: 400, height: 550 };\n  }\n\n  // 安全なパラメータ処理\n  finThickness = getSafeValue(finThickness, 2);\n  finBaseWidth = getSafeValue(finBaseWidth, 30);\n  finSweepLength = getSafeValue(finSweepLength, 0);\n  finTipWidth = getSafeValue(finTipWidth, 20);\n  \n  const halfThickness = finThickness / 2;\n  const finBottomY = config.height;\n  const finTopY = finBottomY - finBaseWidth;\n\n  // フィンの後端が左右のフィンと揃うように調整\n  const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n\n  return `M ${config.centerX - halfThickness} ${finTopY}\n          L ${config.centerX - halfThickness} ${finBottomY}\n          L ${config.centerX - halfThickness} ${finBottomY + finExtension}\n          L ${config.centerX + halfThickness} ${finBottomY + finExtension}\n          L ${config.centerX + halfThickness} ${finBottomY}\n          L ${config.centerX + halfThickness} ${finTopY} Z`;\n};\n\n// 姿勢表示用に中央のフィンを描画する関数\nexport const getCenterFinsPathForAttitude = (x, y, params) => {\n  // configが有効かどうかを確認\n  if (!config || typeof config !== 'object' || !('centerX' in config) || !('height' in config)) {\n    console.warn('getCenterFinsPathForAttitude: Invalid config object', config);\n    // デフォルト設定を作成\n    config = { centerX: 400, height: 550 };\n  }\n\n  // 安全なパラメータ処理\n  finThickness = getSafeValue(finThickness, 2);\n  finBaseWidth = getSafeValue(finBaseWidth, 30);\n  finSweepLength = getSafeValue(finSweepLength, 0);\n  finTipWidth = getSafeValue(finTipWidth, 20);\n\n  const halfThickness = params.finThickness / 2;\n  const finBottomY = y;\n  const finTopY = finBottomY - params.finBaseWidth;\n  \n  // フィンの翼端位置を正確に計算\n  const tipTopY = finTopY + params.finSweepLength;\n  const tipBottomY = tipTopY + params.finTipWidth;\n  \n  // フィンの後端が左右のフィンと揃うように調整\n  // フィンの翼端長がボディ後端よりも伸びる場合を計算\n  const finExtension = Math.max(0, params.finSweepLength + params.finTipWidth - params.finBaseWidth);\n  \n  return `M ${x - halfThickness} ${finTopY}\n          L ${x - halfThickness} ${finBottomY}\n          L ${x - halfThickness} ${finBottomY + finExtension}\n          L ${x + halfThickness} ${finBottomY + finExtension}\n          L ${x + halfThickness} ${finBottomY}\n          L ${x + halfThickness} ${finTopY} Z`;\n};\n\n// シミュレーションタブ用のロケット描画関数を追加\nexport const drawInitialRocket = (centerX, centerY, params, rotation) => {\n    // 回転を考慮した変換\n    const transform = `translate(${centerX}, ${centerY}) rotate(${rotation})`;\n    \n    // 各部品のパス計算\n    const bodyPath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                     L ${-params.bodyWidth / 2} ${0} \n                     L ${params.bodyWidth / 2} ${0} \n                     L ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n                     \n    let nosePath;\n    if (params.noseShape === \"cone\") {\n      nosePath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                  L ${0} ${-params.bodyHeight - params.noseHeight} \n                  L ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n    } else if (params.noseShape === \"parabola\") {\n      nosePath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                  Q ${0} ${-params.bodyHeight - params.noseHeight * 1.2}, \n                    ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n    } else { // ogive\n      nosePath = `M ${-params.bodyWidth / 2} ${-params.bodyHeight} \n                  Q ${0} ${-params.bodyHeight - params.noseHeight * 1.1}, \n                    ${params.bodyWidth / 2} ${-params.bodyHeight} Z`;\n    }\n    \n    const leftFinPath = `M ${-params.bodyWidth / 2} ${-params.finBaseWidth} \n                         L ${-params.bodyWidth / 2} ${0} \n                         L ${-params.bodyWidth / 2 - params.finHeight} ${params.finSweepLength} \n                         L ${-params.bodyWidth / 2 - params.finHeight} ${params.finSweepLength - params.finTipWidth} Z`;\n    \n    const rightFinPath = `M ${params.bodyWidth / 2} ${-params.finBaseWidth} \n                          L ${params.bodyWidth / 2} ${0} \n                          L ${params.bodyWidth / 2 + params.finHeight} ${params.finSweepLength} \n                          L ${params.bodyWidth / 2 + params.finHeight} ${params.finSweepLength - params.finTipWidth} Z`;\n    \n    return {\n      transform,\n      bodyPath,\n      nosePath,\n      leftFinPath,\n      rightFinPath,\n      centerFinsPath: `M ${-params.finThickness / 2} ${-params.finBaseWidth} \n                      L ${-params.finThickness / 2} ${0} \n                      L ${params.finThickness / 2} ${0} \n                      L ${params.finThickness / 2} ${-params.finBaseWidth} Z`\n    };\n  };\n\n// フィンを取得する総合的な関数\nexport const getFinPaths = (x, y, params, deflection = 0) => {\n  const bodyLeftX = x - params.bodyWidth / 2;\n  const bodyRightX = x + params.bodyWidth / 2;\n  const finBottomY = y;\n  const finTopY = finBottomY - params.finBaseWidth;\n  \n  // たわみを考慮した修正\n  const deflectionAngle = deflection * Math.PI / 180; // ラジアンに変換\n  \n  // 翼端長がボディ後端より後ろに出るように調整\n  const tipTopY = finTopY + params.finSweepLength;\n  const tipBottomY = tipTopY + params.finTipWidth;\n  \n  // たわみを適用したフィン座標\n  const leftFinTipX = bodyLeftX - params.finHeight * Math.cos(deflectionAngle);\n  const leftFinTipY = tipTopY + params.finHeight * Math.sin(deflectionAngle);\n  const leftFinBottomTipX = bodyLeftX - params.finHeight * Math.cos(deflectionAngle);\n  const leftFinBottomTipY = tipBottomY + params.finHeight * Math.sin(deflectionAngle);\n  \n  const rightFinTipX = bodyRightX + params.finHeight * Math.cos(deflectionAngle);\n  const rightFinTipY = tipTopY + params.finHeight * Math.sin(deflectionAngle);\n  const rightFinBottomTipX = bodyRightX + params.finHeight * Math.cos(deflectionAngle);\n  const rightFinBottomTipY = tipBottomY + params.finHeight * Math.sin(deflectionAngle);\n\n  const leftFin = `M ${bodyLeftX} ${finTopY}\n                  L ${bodyLeftX} ${finBottomY}\n                  L ${leftFinBottomTipX} ${leftFinBottomTipY}\n                  L ${leftFinTipX} ${leftFinTipY} Z`;\n\n  const rightFin = `M ${bodyRightX} ${finTopY}\n                  L ${bodyRightX} ${finBottomY}\n                  L ${rightFinBottomTipX} ${rightFinBottomTipY}\n                  L ${rightFinTipX} ${rightFinTipY} Z`;\n\n  const halfThickness = params.finThickness / 2;\n  const centerFins = `M ${x - halfThickness} ${finTopY}\n                    L ${x - halfThickness} ${finBottomY}\n                    L ${x + halfThickness} ${finBottomY}\n                    L ${x + halfThickness} ${finTopY} Z`;\n\n  return { leftFin, rightFin, centerFins };\n};\n\n// 風向き矢印の描画関数\nexport const getWindArrow = (windSpeed) => {\n  if (windSpeed === 0) return null;\n  \n  // 風速に基づいた矢印の長さ\n  const arrowLength = Math.min(100, Math.max(40, Math.abs(windSpeed) * 10));\n  \n  // 「風速: X m/s」テキストの中央位置\n  const textCenter = 85; // テキスト中央のx座標\n  const y = 50; // テキスト下のy座標\n  \n  // 矢印の色と太さを取得\n  const color = getWindArrowColor(windSpeed);\n  const strokeWidth = getWindArrowWidth(windSpeed);\n  \n  // 矢印の頭の大きさ\n  const headSize = 15;\n  \n  // 風速の符号で場合分け\n  if (windSpeed < 0) {\n    // マイナスの場合 - 右向き矢印\n    const startX = textCenter - arrowLength / 2;\n    const endX = textCenter + arrowLength / 2;\n    \n    return {\n      line: `M ${startX} ${y} L ${endX} ${y}`,\n      head: `M ${endX - headSize} ${y - headSize/2} L ${endX} ${y} L ${endX - headSize} ${y + headSize/2}`,\n      y: y,\n      color: color,\n      strokeWidth: strokeWidth\n    };\n  } else {\n    // プラスの場合 - 左向き矢印だが、矢じりは右端\n    const lineStart = textCenter - arrowLength / 2;\n    const lineEnd = textCenter + arrowLength / 2;\n    \n    return {\n      line: `M ${lineStart} ${y} L ${lineEnd} ${y}`,\n      head: `M ${lineStart + headSize} ${y - headSize/2} L ${lineStart} ${y} L ${lineStart + headSize} ${y + headSize/2}`,\n      y: y,\n      color: color,\n      strokeWidth: strokeWidth\n    };\n  }\n};\n\n// 風速に応じた矢印の色を取得する関数\nexport const getWindArrowColor = (speed) => {\n  const absSpeed = Math.abs(speed);\n  if (absSpeed >= 6) return \"#e74c3c\"; // 強風: 赤色\n  if (absSpeed >= 3) return \"#f39c12\"; // 中風: オレンジ/黄色\n  return \"#2ecc71\"; // 弱風: 緑色\n};\n\n// 風速に応じた矢印の線の太さを取得する関数\nexport const getWindArrowWidth = (speed) => {\n  const absSpeed = Math.abs(speed);\n  if (absSpeed >= 6) return 5; // 強風: より太い線\n  if (absSpeed >= 3) return 4; // 中風: やや太い線\n  return 3; // 弱風: 通常の線\n};\n\n// パラシュート表示を改良\nexport const getParachutePath = (x, y, isOpen, deploymentProgress = 1.0, rotation = 0, rocketLength, selectedParachute, trajectoryScale) => {\n  if (!isOpen) return \"\";\n\n  // ロケットの長さを基準に計算\n  // 基準距離を短くして調整（1.5倍にする）\n  const baseOffsetDistance = rocketLength * 1.5; \n  const offsetDistance = baseOffsetDistance * trajectoryScale * deploymentProgress;\n\n  // 機体の上部に常に配置するため、回転角度を無視\n  // xは変更せず、yだけ上方向に移動\n  const parachuteX = x;\n  const parachuteY = y - offsetDistance;\n\n  // パラシュートサイズの計算\n  const parachuteSize = (parseInt(selectedParachute.slice(1)) / 1000 / 2) * trajectoryScale * deploymentProgress;\n\n  // パラシュートのパスを描画\n  return `M ${parachuteX - parachuteSize} ${parachuteY}\n          C ${parachuteX - parachuteSize} ${parachuteY - parachuteSize * 0.8},\n            ${parachuteX} ${parachuteY - parachuteSize * 1.2},\n            ${parachuteX + parachuteSize} ${parachuteY - parachuteSize * 0.8}\n          C ${parachuteX + parachuteSize} ${parachuteY - parachuteSize * 0.8},\n            ${parachuteX + parachuteSize} ${parachuteY},\n            ${parachuteX + parachuteSize} ${parachuteY}\n          Z`;\n};\n\n// パラシュートの紐を描画\nexport const getParachuteStringPaths = (x, y, isOpen, deploymentProgress = 1.0, rotation = 0, rocketLength, selectedParachute, trajectoryScale) => {\n  if (!isOpen) return '';\n\n  // パラシュート本体と全く同じ計算を使用して一貫性を確保\n  const baseOffsetDistance = rocketLength * 1.5; \n  const offsetDistance = baseOffsetDistance * trajectoryScale * deploymentProgress;\n\n  // 機体の上部に常に配置\n  const parachuteX = x;\n  const parachuteY = y - offsetDistance;\n\n  // パラシュートサイズも同一の計算で\n  const parachuteSize = (parseInt(selectedParachute.slice(1)) / 1000 / 2) * trajectoryScale * deploymentProgress;\n\n  // キャノピーの各部分の座標を計算\n  const canopyLeftX = parachuteX - parachuteSize;\n  const canopyRightX = parachuteX + parachuteSize;\n  const canopyBottomY = parachuteY;\n  const canopyCenterX = parachuteX;\n  const canopyCenterTopY = parachuteY - parachuteSize * 0.5;\n\n  // 紐のパスを描画 - ロケット位置からキャノピーの各点まで\n  return `M ${x} ${y} L ${canopyLeftX} ${canopyBottomY}\n          M ${x} ${y} L ${canopyCenterX} ${canopyCenterTopY}\n          M ${x} ${y} L ${canopyRightX} ${canopyBottomY}`;\n};\n\n// メートル単位からSVG座標への変換関数\nexport const metersToSvgX = (meters, trajectoryScale) => {\n  // NaNチェック追加\n  if (isNaN(meters)) {\n    console.warn('metersToSvgX: 無効なメートル値', meters);\n    return SVG_CONFIG.centerX;\n  }\n  \n  // trajectoryScaleが数値でない場合のフォールバック\n  if (typeof trajectoryScale !== 'number' || isNaN(trajectoryScale) || trajectoryScale <= 0) {\n    console.warn('metersToSvgX: 無効なtrajectoryScale', trajectoryScale);\n    trajectoryScale = 10.0; // より安全なデフォルト値\n  }\n  \n  return SVG_CONFIG.centerX + meters * trajectoryScale;\n};\n\nexport const metersToSvgY = (meters, trajectoryScale) => {\n  // NaNチェック\n  if (isNaN(meters)) {\n    console.warn('metersToSvgY: 無効なメートル値', meters);\n    return SVG_CONFIG.groundLevel;\n  }\n  \n  // trajectoryScaleが数値でない場合のフォールバック\n  if (typeof trajectoryScale !== 'number' || isNaN(trajectoryScale) || trajectoryScale <= 0) {\n    console.warn('metersToSvgY: 無効なtrajectoryScale', trajectoryScale);\n    trajectoryScale = 10.0; // より安全なデフォルト値\n  }\n  \n  return SVG_CONFIG.groundLevel - meters * trajectoryScale;\n};\n\n// 安全な回転属性を生成する関数\nexport const getSafeRotationTransform = (rotation, x, y) => {\n  // 全ての値にNaNチェック\n  const safeRotation = isNaN(rotation) ? 0 : rotation;\n  const safeX = isNaN(x) ? SVG_CONFIG.centerX : x;\n  const safeY = isNaN(y) ? SVG_CONFIG.groundLevel : y;\n\n  return `rotate(${safeRotation} ${safeX} ${safeY})`;\n};\n\n// 姿勢表示用のロケットスケールを自動計算する関数を追加\nexport const calculateAttitudeDisplayScale = (rocketParams, circleRadius = 90) => {\n  try {\n    // 必要なパラメータを安全に取得\n    const noseHeight = getSafeValue(rocketParams.noseHeight, 50);\n    const bodyHeight = getSafeValue(rocketParams.bodyHeight, 200);\n    const finSweepLength = getSafeValue(rocketParams.finSweepLength, 0);\n    const finTipWidth = getSafeValue(rocketParams.finTipWidth, 20);\n    const finBaseWidth = getSafeValue(rocketParams.finBaseWidth, 30);\n    \n    // ロケットの寸法を計算\n    const actualRocketHeight = noseHeight + bodyHeight;\n    const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n    const totalHeight = actualRocketHeight + finExtension;\n    \n    // スケール計算 - 安全範囲内に制限\n    const rawScale = (circleRadius * 1.6) / Math.max(50, totalHeight);\n    return Math.max(0.01, Math.min(2.0, rawScale));\n  } catch (error) {\n    console.error('calculateAttitudeDisplayScale エラー:', error);\n    return 0.3; // エラー時のデフォルト値\n  }\n};\n\n// 視覚化のための風速高度分布矢印を描画する関数\nexport const getWindProfileArrows = (baseWindSpeed, profile, showWindArrows, metersToSvgY, calculateWindSpeedAtHeight) => {\n  if (!showWindArrows) return [];\n  \n  // 表示する高度レベル（メートル）\n  const heights = [0, 20, 40, 60, 80];\n  \n  return heights.map(height => {\n    // 各高度での風速を計算\n    const windSpeed = calculateWindSpeedAtHeight(baseWindSpeed, height, profile);\n    \n    // SVG座標に変換\n    const y = metersToSvgY(height);\n    \n    // 風速によって矢印の長さを制限して表示範囲内に収める\n    // 最大長さをより小さく設定し、範囲内に確実に収める\n    const maxArrowLength = 60; // 最大長さを短くして確実に範囲内に収める\n    const minArrowLength = 20; // 最小長さ\n    const arrowLength = Math.min(maxArrowLength, Math.max(minArrowLength, Math.abs(windSpeed) * 6));\n    \n    const color = getWindArrowColor(windSpeed);\n    const strokeWidth = getWindArrowWidth(windSpeed);\n    \n    // 表示位置の調整 - 右に寄せて表示するように修正\n    const startX = 80; // 右寄りに配置\n    // 矢印の向きを修正 - 既存の風向き矢印と同じロジック\n    const direction = windSpeed < 0 ? 1 : -1;  // 負の風速で右向き、正の風速で左向き\n    \n    // 矢印の端点の位置を計算\n    const endX = startX + arrowLength * direction;\n    \n    // テキスト位置の調整\n    // 矢印の長さと方向に応じてテキスト位置を調整し、矢印から適切な距離に配置\n    const textOffsetX = direction > 0 ? 12 : -35; // テキストのオフセット\n    \n    return {\n      height,\n      windSpeed,\n      y,\n      arrowPath: {\n        // 矢印の線\n        line: `M ${startX} ${y} L ${endX} ${y}`,\n        // 矢印の頭\n        head: direction > 0 \n          ? `M ${endX - 10} ${y - 5} L ${endX} ${y} L ${endX - 10} ${y + 5}`\n          : `M ${endX + 10} ${y - 5} L ${endX} ${y} L ${endX + 10} ${y + 5}`,\n        // 風速テキスト - 常に表示範囲内に収まるように位置調整\n        textX: endX + textOffsetX,\n        textY: y,\n        color,\n        strokeWidth\n      }\n    };\n  });\n};\n\n// ロケット寸法計算関数\nexport const getActualRocketDimensions = (config, noseHeight, bodyHeight, finSweepLength, finTipWidth, finBaseWidth) => {\n  const rocketTopY = config.height - bodyHeight - noseHeight;\n  // 機体全長の計算 - ノーズとボディの高さ\n  const actualRocketHeight = noseHeight + bodyHeight;\n  // フィンの後端がボディ後端よりも出る場合の計算\n  const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n  // 全長は機体長 + フィン後端部分\n  const totalHeight = actualRocketHeight + finExtension;\n\n  return { rocketTopY, actualRocketHeight, totalHeight };\n};\n\n// 設計タブ用のviewBox計算関数\nexport const getDesignViewBox = (design, noseHeight, bodyHeight, finHeight, finSweepLength, finTipWidth, finBaseWidth, bodyWidth) => {\n  // 直接ロケット寸法を計算\n  const rocketTopY = design.height - bodyHeight - noseHeight;\n  const actualRocketHeight = noseHeight + bodyHeight;\n  const finExtension = Math.max(0, finSweepLength + finTipWidth - finBaseWidth);\n  const totalHeight = actualRocketHeight + finExtension;\n  \n  // フィンの左右の最大幅を計算\n  const maxFinWidth = finHeight;\n\n  // 左右のマージンを追加 - より広いマージンを確保\n  const horizontalMargin = Math.max(maxFinWidth + 20, design.width * 0.25);\n  \n  // 垂直方向のマージンを追加 - 新規追加\n  const verticalMargin = Math.max(totalHeight * 0.2, 50);\n  \n  // 全幅 (ボディ幅 + 左右のフィン)\n  const totalWidth = bodyWidth + (maxFinWidth * 2);\n  \n  // 余裕を持たせた表示エリアのサイズ - 余裕を増やす\n  const paddedHeight = totalHeight * 1.4; // 40%の余裕に増加\n  const paddedWidth = totalWidth * 1.4;  // 40%の余裕に増加\n  \n  // 表示エリアのアスペクト比\n  const viewBoxAspectRatio = design.width / design.height;\n  \n  // ロケットのアスペクト比と比較して表示方法を決定\n  let viewBoxWidth, viewBoxHeight;\n  \n  if (paddedWidth / paddedHeight > viewBoxAspectRatio) {\n    // 幅が制限要素の場合\n    viewBoxWidth = paddedWidth;\n    viewBoxHeight = paddedWidth / viewBoxAspectRatio;\n  } else {\n    // 高さが制限要素の場合\n    viewBoxHeight = paddedHeight;\n    viewBoxWidth = paddedHeight * viewBoxAspectRatio;\n  }\n  \n  // 表示領域を計算 - 上部に余裕を持たせるように変更\n  return `-${horizontalMargin} -${verticalMargin} ${design.width + horizontalMargin * 2} ${design.height + verticalMargin * 2}`;\n};\n\n// 重量・空力特性タブ用のviewBox計算関数（改善版）\nexport const getAnalysisViewBox = () => {\n    // ロケットが確実に中央に表示されるようなviewBox\n    return \"-200 -400 400 800\";\n  };\n\n// ロケットの拡大率を計算する関数\nexport const calculateRocketScale = (totalHeight, canvasHeight) => {\n  // 画面の70%を使うように計算\n  const targetHeight = canvasHeight * 0.7;\n  \n  // スケール係数の計算\n  const scale = targetHeight / totalHeight;\n  \n  // 最小・最大スケール値の制限\n  return Math.max(0.5, Math.min(2.0, scale));\n};\n\n// ロケットのSVG位置変換を計算する関数\nexport const getRocketTransform = (totalHeight, canvasWidth, canvasHeight) => {\n  // 動的なスケール計算\n  const scale = calculateRocketScale(totalHeight, canvasHeight);\n  \n  // 移動量の計算（キャンバスの中央に配置）\n  const translateX = canvasWidth / 2;\n  const translateY = canvasHeight / 2 - (totalHeight * scale / 2);\n  \n  return {\n    translateX,\n    translateY,\n    scale,\n    transform: `translate(${translateX}, ${translateY}) scale(${scale})`\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}